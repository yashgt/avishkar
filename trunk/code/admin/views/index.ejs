<!DOCTYPE html>
<html xmlns:ng="http://angularjs.org" id='ng-app' ng-app="adminApp">
  <head>

    <title>Fleet Manager</title>
	
	<script src="javascripts/bower_components/jquery/dist/jquery.min.js"></script>
	
	
	<script src="http://maps.googleapis.com/maps/api/js?libraries=weather,geometry,visualization&sensor=false&language=en&v=3.14"></script>
	<script src="javascripts/ContextMenu.js"></script>
	
	<script src="//ajax.googleapis.com/ajax/libs/angularjs/1.2.10/angular.js"></script>
	<!--<script src="//netdna.bootstrapcdn.com/twitter-bootstrap/2.3.2/js/bootstrap.min.js"></script>-->
	<script src="//cdnjs.cloudflare.com/ajax/libs/lodash.js/2.4.1/lodash.min.js" type="text/javascript"></script>
	<script src="//angular-ui.github.io/bootstrap/ui-bootstrap-tpls-0.11.0.js" type="text/javascript"></script>


<script src="javascripts/bower_components/angular-google-maps/dist/angular-google-maps.js"></script>
	
	<script src="javascripts/RouteController.js"></script>
	
    <link rel='stylesheet' href='/stylesheets/style.css' />
	<link rel='stylesheet' href='/stylesheets/map.css' /> 
	<link rel='stylesheet' href='/stylesheets/context_menu.css' />
	<link href="//netdna.bootstrapcdn.com/bootstrap/3.1.1/css/bootstrap.min.css" rel="stylesheet" type="text/css">

  </head>
  <body ng-controller="RouteController">

	<div>
	<p>Fleet : {{selectedFleet}}</p>
      <select ng-model="selectedFleet">
        <option ng-repeat="fleet in fleets" value="{{fleet}}">{{fleet}}</option>
      </select>
	  Logged in as <%= user.name %>, <% if(user.role == 'FLEETADMIN') { %> Fleet Administrator <% } %>
	  <a href='/logout'>Logout</a>
	<tabset vertical="false" justified="false">
    <tab heading="Routes">
	<table border="1" width=100% height=100%>
                <tr>
                <td width=15% valign="top">
                    <div class="center">
                      <center><b>Routes</b></center>
                    </div>
				</td>
				<td width=70% valign="top">
                        <div id="route">
                            <form>
                             <div class="center">
                               <center>
                                <button type="submit" ng-click="newRoute()">New Route</button>
                                <button type="submit" ng-click="saveRoute()" ng-disabled="routeDetail.stops.length < 4">Save Current Route</button>
								<button type="submit" ng-click="extendRoute()" ng-disabled="routeDetail.routeId < 0 ">Extend Current Route</button>
                                <button type="submit" ng-click="deQueue()">Deque Route Stops</button>
                               </center>
                             </div>
							</form>
						</div>	
			<tabset vertical="false" justified="false">
			<tab heading="Map">

			<div id="map" 
			google-map="exp" class="span7"
				events="map.events"
				zoom="fleetDetail.zoom"
				center="fleetDetail.center"
				 draggable="true"
				 bounds="fleetDetail.bounds"
				 pan="true"
				 control="map.control">
				 
			<script>
				$(function(){
				var scope = angular.element($('#map')).scope();
				scope.configMap();
				});
		
			</script>
		
			<window show="map.infoWindow.show" coords="stopDetail" isIconVisibleOnClick="false" options="map.infoWindow.options"  ng-cloak>
				<div >
					
					
					<form name="stop_form" ng-controller="StopController" ng-submit="saveStop()" novalidate>
						<p>Adding stop at {{ stopDetail.latitude | number:4 }}°N, {{ stopDetail.longitude | number:4 }}°E</p>
						
						TODO CBM add validations
						<input type="text" name="stopName" placeholder="Stop Name" ng-model="stopDetail.stopName" />
						<br/>
						<textarea ng-model="stopDetail.address" placeholder="Stop Address" ></textarea>
						<br/>
						<button type="submit" ng-disabled="stop_form.$invalid">Save</button>
						
					</form>	
					
				</div>
			</window>
			
			<markers models="fleetDetail.stops" coords="'self'" icon="'icon'" click="'onClicked'">
			</markers>

		</div>
		</tab> <!--Map tab ends -->
		<tab heading="Schedule-CM"></tab>
		<tab heading="Fares-CM"></tab>
		</tabset>
		</td>
				
				<td width=15% valign="top">
				 <div id="route">
				<tabset>
                         <tab heading="Onward-YG"></tab>
						 <tab heading="Return"></tab>
				</tabset>
				</td>		
	</tr>
	</table>

	</tab>
	<tab heading="Calendars-AN"></tab>
	</tabset>
	</div>
  </body>
</html>